<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Implementation of FTRL (Follow The Regularized Leader) — FTRL • opera</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Implementation of FTRL (Follow The Regularized Leader) — FTRL" />
<meta property="og:description" content="FTRL (Shalev-Shwartz and Singer 2007)
 and Chap. 5 of (Hazan 2019)
 is the online counterpart of empirical risk minimization. 
 It is a family of aggregation rules (including OGD) that uses at any time the empirical risk
 minimizer so far with an additional regularization. The online optimization can be performed
 on any bounded convex set that can be expressed with equality or inequality constraints. 
 Note that this method is still under development and a beta version." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">opera</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/opera-vignette.html">`opera` package</a>
    </li>
    <li>
      <a href="../articles/regional_forecasting.html">Hierarchical Forecasting with Opera</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dralliag/opera/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Implementation of FTRL (Follow The Regularized Leader)</h1>
    <small class="dont-index">Source: <a href='https://github.com/dralliag/opera/blob/master/R/FTRL.R'><code>R/FTRL.R</code></a></small>
    <div class="hidden name"><code>FTRL.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>FTRL (Shalev-Shwartz and Singer 2007)
 and Chap. 5 of (Hazan 2019)
 is the online counterpart of empirical risk minimization. 
 It is a family of aggregation rules (including OGD) that uses at any time the empirical risk
 minimizer so far with an additional regularization. The online optimization can be performed
 on any bounded convex set that can be expressed with equality or inequality constraints. 
 Note that this method is still under development and a beta version.</p>
    </div>

    <pre class="usage"><span class='fu'>FTRL</span><span class='op'>(</span>
  <span class='va'>y</span>,
  <span class='va'>experts</span>,
  eta <span class='op'>=</span> <span class='cn'>NULL</span>,
  fun_reg <span class='op'>=</span> <span class='cn'>NULL</span>,
  fun_reg_grad <span class='op'>=</span> <span class='cn'>NULL</span>,
  constr_eq <span class='op'>=</span> <span class='cn'>NULL</span>,
  constr_eq_jac <span class='op'>=</span> <span class='cn'>NULL</span>,
  constr_ineq <span class='op'>=</span> <span class='cn'>NULL</span>,
  constr_ineq_jac <span class='op'>=</span> <span class='cn'>NULL</span>,
  loss.type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"square"</span><span class='op'>)</span>,
  loss.gradient <span class='op'>=</span> <span class='cn'>TRUE</span>,
  w0 <span class='op'>=</span> <span class='cn'>NULL</span>,
  max_iter <span class='op'>=</span> <span class='fl'>50</span>,
  obj_tol <span class='op'>=</span> <span class='fl'>0.01</span>,
  training <span class='op'>=</span> <span class='cn'>NULL</span>,
  default <span class='op'>=</span> <span class='cn'>FALSE</span>,
  quiet <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p><code>vector</code>. Real observations.</p></td>
    </tr>
    <tr>
      <th>experts</th>
      <td><p><code>matrix</code>. Matrix of experts previsions.</p></td>
    </tr>
    <tr>
      <th>eta</th>
      <td><p><code>numeric</code>. Regularization parameter.</p></td>
    </tr>
    <tr>
      <th>fun_reg</th>
      <td><p><code>function</code> (NULL). Regularization function to be applied during the optimization.</p></td>
    </tr>
    <tr>
      <th>fun_reg_grad</th>
      <td><p><code>function</code> (NULL). Gradient of the regularization function (to speed up the computations).</p></td>
    </tr>
    <tr>
      <th>constr_eq</th>
      <td><p><code>function</code> (NULL). Constraints (equalities) to be applied during the optimization.</p></td>
    </tr>
    <tr>
      <th>constr_eq_jac</th>
      <td><p><code>function</code> (NULL). Jacobian of the equality constraints (to speed up the computations).</p></td>
    </tr>
    <tr>
      <th>constr_ineq</th>
      <td><p><code>function</code> (NULL). Constraints (inequalities) to be applied during the optimization (... &gt; 0).</p></td>
    </tr>
    <tr>
      <th>constr_ineq_jac</th>
      <td><p><code>function</code> (NULL). Jacobian of the inequality constraints (to speed up the computations).</p></td>
    </tr>
    <tr>
      <th>loss.type</th>
      <td><p><code>character, list or function</code> ("square").</p><dl>
     <dt>character</dt><dd><p>Name of the loss to be applied ('square', 'absolute', 'percentage', or 'pinball');</p></dd>
     <dt>list</dt><dd><p>List with field <code>name</code> equal to the loss name. If using pinball loss, field <code>tau</code> equal to the required quantile in [0,1];</p></dd>
     <dt>function</dt><dd><p>A custom loss as a function of two parameters (prediction, label).</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>loss.gradient</th>
      <td><p><code>boolean, function</code> (TRUE).</p><dl>
     <dt>boolean</dt><dd><p>If TRUE, the aggregation rule will not be directly applied to the loss function at hand,
     but to a gradient version of it. The aggregation rule is then similar to gradient descent aggregation rule.</p></dd>
     <dt>function</dt><dd><p>If loss.type is a function, the derivative of the loss in its first component should be provided to be used (it is not automatically 
     computed).</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>w0</th>
      <td><p><code>numeric</code> (NULL). Vector of initialization for the weights.</p></td>
    </tr>
    <tr>
      <th>max_iter</th>
      <td><p><code>integer</code> (50). Maximum number of iterations of the optimization algorithm per round.</p></td>
    </tr>
    <tr>
      <th>obj_tol</th>
      <td><p><code>numeric</code> (1e-2). Tolerance over objective function between two iterations of the optimization.</p></td>
    </tr>
    <tr>
      <th>training</th>
      <td><p><code>list</code> (NULL). List of previous parameters.</p></td>
    </tr>
    <tr>
      <th>default</th>
      <td><p><code>boolean</code> (FALSE). Whether or not to use default parameters for fun_reg, constr_eq, constr_ineq and their grad/jac, 
which values are ALL ignored when TRUE.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p><code>boolean</code> (FALSE). Whether or not to display progress bars.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>object of class mixture.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hazan E (2019).
&#8220;Introduction to online convex optimization.&#8221;
<em>arXiv preprint arXiv:1909.05207</em>.<br /><br /> Shalev-Shwartz S, Singer Y (2007).
&#8220;A primal-dual perspective of online learning algorithms.&#8221;
<em>Machine Learning</em>, <b>69</b>(2), 115--142.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pierre Gaillard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


