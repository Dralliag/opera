<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute an aggregation rule — mixture • opera</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute an aggregation rule — mixture"><meta property="og:description" content="The function mixture builds an
aggregation rule chosen by the user. 
It can then be used to predict new observations Y sequentially.
If observations Y and expert advice experts are provided, 
mixture is trained by predicting the observations in Y
sequentially with the help of the expert advice in experts.  
At each time instance \(t=1,2,\dots,T\), the mixture forms a prediction of Y[t,] by assigning 
a weight to each expert and by combining the expert advice."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">opera</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/opera-vignette.html">`opera` package</a>
    </li>
    <li>
      <a href="../articles/regional_forecasting.html">Hierarchical Forecasting with Opera</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dralliag/opera/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute an aggregation rule</h1>
    <small class="dont-index">Source: <a href="https://github.com/dralliag/opera/blob/HEAD/R/mixture.R" class="external-link"><code>R/mixture.R</code></a>, <a href="https://github.com/dralliag/opera/blob/HEAD/R/print-mixture.R" class="external-link"><code>R/print-mixture.R</code></a>, <a href="https://github.com/dralliag/opera/blob/HEAD/R/summary-mixture.R" class="external-link"><code>R/summary-mixture.R</code></a></small>
    <div class="hidden name"><code>mixture-opera.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>mixture</code> builds an
aggregation rule chosen by the user. 
It can then be used to predict new observations Y sequentially.
If observations <code>Y</code> and expert advice <code>experts</code> are provided, 
<code>mixture</code> is trained by predicting the observations in <code>Y</code>
sequentially with the help of the expert advice in <code>experts</code>.  
At each time instance \(t=1,2,\dots,T\), the mixture forms a prediction of <code>Y[t,]</code> by assigning 
a weight to each expert and by combining the expert advice.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mixture</span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  experts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"MLpol"</span>,</span>
<span>  loss.type <span class="op">=</span> <span class="st">"square"</span>,</span>
<span>  loss.gradient <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  coefficients <span class="op">=</span> <span class="st">"Uniform"</span>,</span>
<span>  awake <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mixture</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mixture</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Y</dt>
<dd><p>A matrix with T rows and d columns. Each row <code>Y[t,]</code> contains a d-dimensional 
observation to be predicted sequentially.</p></dd>


<dt>experts</dt>
<dd><p>An array of dimension <code>c(T,d,K)</code>, where <code>T</code> is the length of the data-set, 
<code>d</code> the dimension of the observations, and <code>K</code> is the number of experts. It contains the expert
forecasts. Each vector <code>experts[t,,k]</code> corresponds to the d-dimensional prediction of <code>Y[t,]</code> 
proposed by expert k at time \(t=1,\dots,T\).
In the case of real prediction (i.e., \(d = 1\)), <code>experts</code> is a matrix with <code>T</code> rows and <code>K</code> columns.</p></dd>


<dt>model</dt>
<dd><p>A character string specifying the aggregation rule to use. 
Currently available aggregation rules are:</p><dl><dt>'EWA'</dt>
<dd><p>Exponentially weighted average aggregation rules (Cesa-Bianchi and Lugosi 2006)
. A positive learning rate <strong>eta</strong> 
can be chosen by the user. The
bigger it is the faster the aggregation rule will learn from observations
and experts performances. However, too high values lead to unstable weight
vectors and thus unstable predictions. If it is not specified, the learning rate is calibrated online. 
A finite grid of potential learning rates to be optimized online can be specified with <strong>grid.eta</strong>.</p></dd>

   <dt>'FS'</dt>
<dd><p>Fixed-share aggregation rule (Cesa-Bianchi and Lugosi 2006)
. As for <code>ewa</code>, a learning rate <strong>eta</strong> 
can be chosen by the user or calibrated online. The main difference with <code>ewa</code> aggregation
rule rely in the mixing rate <strong>alpha</strong>\(\in [0,1]\) which considers at
each instance a small probability <code>alpha</code> to have a rupture in the
sequence and that the best expert may change. Fixed-share aggregation rule
can thus compete with the best sequence of experts that can change a few
times (see <code><a href="oracle.html">oracle</a></code>), while <code>ewa</code> can only
compete with the best fixed expert. The mixing rate <strong>alpha</strong> is either chosen by the user either calibrated online.
Finite grids of learning rates and mixing rates to be optimized can be specified with 
parameters <strong>grid.eta</strong> and <strong>grid.alpha</strong>.</p></dd>

   <dt>'Ridge'</dt>
<dd><p>Online Ridge regression (Cesa-Bianchi and Lugosi 2006)
. It minimizes at
each instance a penalized criterion.  It forms at each instance linear
combination of the experts' forecasts and can assign negative weights that
not necessarily sum to one.  It is useful if the experts are biased or
correlated. It cannot be used with specialized experts. A positive regularization coefficient <strong>lambda</strong> 
can either be chosen by the user or calibrated online. 
A finite grid of coefficient to be optimized can be specified with a parameter <strong>grid.lambda</strong>.</p></dd>

   <dt>'MLpol', 'MLewa', 'MLprod'</dt>
<dd><p>Aggregation rules with multiple learning rates that are
theoretically calibrated (Gaillard et al. 2014)
.</p></dd>

   <dt>'BOA'</dt>
<dd><p>Bernstein online Aggregation (Wintenberger 2017)
. 
The learning rates are automatically calibrated.</p></dd>

<dt>'OGD'</dt>
<dd><p>Online Gradient descent (Zinkevich 2003)
. See also (Hazan 2019)
. The optimization is performed with a time-varying learning rate. 
 At time step \(t \geq 1\), the learning rate is chosen to be \(t^{-\alpha}\), where \(\alpha\) is provided by alpha in the parameters argument.
 The algorithm may or not perform a projection step into the simplex space (non-negative weights that sum to one) according to
 the value of the parameter 'simplex' provided by the user.</p></dd>

 <dt>'FTRL'</dt>
<dd><p>Follow The Regularized Leader (Shalev-Shwartz and Singer 2007)
. 
 Note that here, the linearized version of FTRL is implemented  (see Chap. 5 of (Hazan 2019)
).
 <code><a href="FTRL.html">FTRL</a></code> is the online counterpart of empirical risk minimization. It is a family of aggregation rules (including OGD) that uses at any time the empirical risk
 minimizer so far with an additional regularization. The online optimization can be performed
 on any bounded convex set that can be expressed with equality or inequality constraints.  Note that this method is still under development and a beta version.</p> 
<p>The user must provide (in the <strong>parameters</strong>'s list):</p><ul><li><p>'eta' The learning rate.</p></li>
<li><p>'fun_reg' The regularization function to be applied on the weigths. See <code>auglag</code>: fn.</p></li>
<li><p>'constr_eq' The equality constraints (e.g. sum(w) = 1). See <code>auglag</code>: heq.</p></li>
<li><p>'constr_ineq' The inequality constraints (e.g. w &gt; 0). See <code>auglag</code>: hin.</p></li>
<li><p>'fun_reg_grad' (optional) The gradient of the regularization function. See <code>auglag</code>: gr.</p></li>
<li><p>'constr_eq_jac' (optional) The Jacobian of the equality constraints. See <code>auglag</code>: heq.jac</p></li>
<li><p>'constr_ineq_jac' (optional) The Jacobian of the inequality constraints. See <code>auglag</code>: hin.jac</p></li>
</ul><p>or set <strong>default</strong> to TRUE. In the latter, <a href="FTRL.html">FTRL</a> is performed with Kullback regularization (<code>fun_reg(x) = sum(x log (x/w0))</code>
   on the simplex (<code>constr_eq(w) = sum(w) - 1</code> and <code>constr_ineq(w) = w</code>). 
   Parameters <strong>w0</strong> (weight initialization), and <strong>max_iter</strong> can also be provided.</p></dd>


</dl></dd>


<dt>loss.type</dt>
<dd><p><code>character, list, or function</code> ("square").</p><dl><dt>character</dt>
<dd><p>Name of the loss to be applied ('square', 'absolute', 'percentage', or 'pinball');</p></dd>

     <dt>list</dt>
<dd><p>List with field <code>name</code> equal to the loss name. If using pinball loss, field <code>tau</code> equal to the required quantile in [0,1];</p></dd>

     <dt>function</dt>
<dd><p>A custom loss as a function of two parameters (prediction, observation). 
     For example, $f(x,y) = abs(x-y)/y$ for the Mean absolute percentage error or $f(x,y) = (x-y)^2$ for the squared loss.</p></dd>


</dl></dd>


<dt>loss.gradient</dt>
<dd><p><code>boolean, function</code> (TRUE).</p><dl><dt>boolean</dt>
<dd><p>If TRUE, the aggregation rule will not be directly applied to the loss function at hand,
     but to a gradient version of it. The aggregation rule is then similar to gradient descent aggregation rule.</p></dd>

     <dt>function</dt>
<dd><p>Can be provided if loss.type is a function. It should then be
     a sub-derivative of the loss in its first component (i.e., in the prediction).
     For instance, $g(x) = (x-y)$ for the squared loss.</p></dd>


</dl></dd>


<dt>coefficients</dt>
<dd><p>A probability vector of length K containing the prior weights of the experts
(not possible for 'MLpol'). The weights must be non-negative and sum to 1.</p></dd>


<dt>awake</dt>
<dd><p>A matrix specifying the
activation coefficients of the experts. Its entries lie in <code>[0,1]</code>.
Possible if some experts are specialists and do not always form and suggest
prediction. If the expert number <code>k</code> at instance <code>t</code> does not
form any prediction of observation <code>Y_t</code>, we can put
<code>awake[t,k]=0</code> so that the mixture does not consider expert <code>k</code> in
the mixture to predict <code>Y_t</code>.</p></dd>


<dt>parameters</dt>
<dd><p>A list that contains optional parameters for the aggregation rule. 
If no parameters are provided, the aggregation rule is fully calibrated
online. Possible parameters are:</p><dl><dt>eta</dt>
<dd><p>A positive number defining the learning rate. 
   Possible if model is either 'EWA' or 'FS'</p></dd>

   <dt>grid.eta</dt>
<dd><p>A vector of positive numbers defining potential learning rates 
   for 'EWA' of 'FS'.
   The learning rate is then calibrated by sequentially optimizing the parameter in 
   the grid. The grid may be extended online if needed by the aggregation rule.</p></dd>

   <dt>gamma</dt>
<dd><p>A positive number defining the exponential step of extension 
   of grid.eta when it is needed. The default value is 2.</p></dd>

   <dt>alpha</dt>
<dd><p>A number in [0,1]. If the model is 'FS', it defines the mixing rate. 
   If the model is 'OGD', it defines the order of the learning rate: \(\eta_t = t^{-\alpha}\).</p></dd>

   <dt>grid.alpha</dt>
<dd><p>A vector of numbers in [0,1] defining potential mixing rates for 'FS'
   to be optimized online. The grid is fixed over time. The default value is <code>[0.0001,0.001,0.01,0.1]</code>.</p></dd>

   <dt>lambda</dt>
<dd><p>A positive number defining the smoothing parameter of 'Ridge' aggregation rule.</p></dd>

   <dt>grid.lambda</dt>
<dd><p>Similar to <code>grid.eta</code> for the parameter <code>lambda</code>.</p></dd>

   <dt>simplex</dt>
<dd><p>A boolean that specifies if 'OGD' does a project on the simplex. In other words,
   if TRUE (default) the online gradient descent will be under the constraint that the weights sum to 1
   and are non-negative. If FALSE, 'OGD' performs an online gradient descent on K dimensional real space.
   without any projection step.</p></dd>

   <dt>averaged</dt>
<dd><p>A boolean (default is FALSE). If TRUE the coefficients and the weights 
   returned (and used to form the predictions) are averaged over the past. It leads to more stability on the time evolution of the weights but needs
   more regularity assumption on the underlying process generating the data (i.i.d. for instance).</p></dd>


</dl></dd>


<dt>quiet</dt>
<dd><p><code>boolean</code>. Whether or not to display progress bars.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters</p></dd>


<dt>x</dt>
<dd><p>An object of class mixture</p></dd>


<dt>object</dt>
<dd><p>An object of class mixture</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class mixture that can be used to perform new predictions. 
It contains the parameters <code>model</code>, <code>loss.type</code>, <code>loss.gradient</code>,
<code>experts</code>, <code>Y</code>, <code>awake</code>, and the fields</p>
<dl><dt>coefficients</dt>
<dd><p>A vector of coefficients 
assigned to each expert to perform the next prediction.</p></dd>


<dt>weights </dt>
<dd><p>A matrix of dimension <code>c(T,K)</code>, with
<code>T</code> the number of instances to be predicted and <code>K</code> the number of
experts.  Each row contains the convex combination to form the predictions</p></dd>

<dt>prediction </dt>
<dd><p>A matrix with <code>T</code> rows and <code>d</code> columns that contains the
predictions outputted by the aggregation rule.</p></dd>
 
<dt>loss</dt>
<dd><p>The average loss (as stated by parameter <code>loss.type</code>) suffered
by the aggregation rule.</p></dd>

<dt>parameters</dt>
<dd><p>The learning parameters chosen by the aggregation rule or by the user.</p></dd>

<dt>training</dt>
<dd><p>A list that contains useful temporary information of the 
aggregation rule to be updated and to perform predictions.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Cesa-Bianchi N, Lugosi G (2006).
<em>Prediction, learning, and games</em>.
Cambridge university press.<br><br> Gaillard P, Stoltz G, van Erven T (2014).
“A Second-order Bound with Excess Losses.”
In <em>Proceedings of COLT'14</em>, volume 35, 176--196.<br><br> Hazan E (2019).
“Introduction to online convex optimization.”
<em>arXiv preprint arXiv:1909.05207</em>.<br><br> Shalev-Shwartz S, Singer Y (2007).
“A primal-dual perspective of online learning algorithms.”
<em>Machine Learning</em>, <b>69</b>(2), 115--142.<br><br> Wintenberger O (2017).
“Optimal learning with Bernstein online aggregation.”
<em>Machine Learning</em>, <b>106</b>(1), 119--141.<br><br> Zinkevich M (2003).
“Online convex programming and generalized infinitesimal gradient ascent.”
In <em>Proceedings of the 20th international conference on machine learning (icml-03)</em>, 928--936.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <code><a href="opera-package.html">opera-package</a></code> and opera-vignette for a brief example about how to use the package.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pierre Gaillard &lt;pierre@gaillard.me&gt; Yannig Goude &lt;yannig.goude@edf.fr&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://pierre.gaillard.me/opera.html" class="external-link">'opera'</a></span><span class="op">)</span>  <span class="co"># load the package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example: find the best one week ahead forecasting strategy (weekly data)</span></span></span>
<span class="r-in"><span><span class="co"># packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: nlme</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is mgcv 1.8-40. For overview type 'help("mgcv-package")'.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># import data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">electric_load</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idx_data_test</span> <span class="op">&lt;-</span> <span class="fl">620</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">electric_load</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">electric_load</span><span class="op">[</span><span class="op">-</span><span class="va">idx_data_test</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">data_test</span> <span class="op">&lt;-</span> <span class="va">electric_load</span><span class="op">[</span><span class="va">idx_data_test</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Build the expert forecasts </span></span></span>
<span class="r-in"><span><span class="co"># ##########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1) A generalized additive model</span></span></span>
<span class="r-in"><span><span class="va">gam.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">Load</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">IPI</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">Temp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">Time</span>, k<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">Load1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">NumWeek</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gam.forecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam.fit</span>, newdata <span class="op">=</span> <span class="va">data_test</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2) An online autoregressive model on the residuals of a medium term model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Medium term model to remove trend and seasonality (using generalized additive model)</span></span></span>
<span class="r-in"><span><span class="va">detrend.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">Load</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">Time</span>,k<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">NumWeek</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">Temp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">IPI</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">electric_load</span><span class="op">$</span><span class="va">Trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">detrend.fit</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">detrend.fit</span>,newdata <span class="op">=</span> <span class="va">data_test</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">electric_load</span><span class="op">$</span><span class="va">Load.detrend</span> <span class="op">&lt;-</span> <span class="va">electric_load</span><span class="op">$</span><span class="va">Load</span> <span class="op">-</span> <span class="va">electric_load</span><span class="op">$</span><span class="va">Trend</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Residual analysis</span></span></span>
<span class="r-in"><span><span class="va">ar.forecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx_data_test</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">idx_data_test</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ar.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="va">electric_load</span><span class="op">$</span><span class="va">Load.detrend</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">idx_data_test</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ar.forecast</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ar.fit</span><span class="op">)</span><span class="op">$</span><span class="va">pred</span><span class="op">)</span> <span class="op">+</span> <span class="va">electric_load</span><span class="op">$</span><span class="va">Trend</span><span class="op">[</span><span class="va">idx_data_test</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Aggregation of experts</span></span></span>
<span class="r-in"><span><span class="co">###########################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">gam.forecast</span>, <span class="va">ar.forecast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gam'</span>, <span class="st">'ar'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data_test</span><span class="op">$</span><span class="va">Load</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, ylab <span class="op">=</span> <span class="st">'Weekly load'</span>, xlab <span class="op">=</span> <span class="st">'Week'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mixture-opera-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># How good are the expert? Look at the oracles</span></span></span>
<span class="r-in"><span><span class="va">oracle.convex</span> <span class="op">&lt;-</span> <span class="fu"><a href="oracle.html">oracle</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, experts <span class="op">=</span> <span class="va">X</span>, loss.type <span class="op">=</span> <span class="st">'square'</span>, model <span class="op">=</span> <span class="st">'convex'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">oracle.convex</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">oracle.convex</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oracle.default(Y = Y, experts = X, model = "convex", loss.type = "square")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    gam    ar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.751 0.249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       rmse   mape</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best expert oracle:   1480 0.0202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Uniform combination:  1480 0.0206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best convex oracle:   1450 0.0200</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Is a single expert the best over time ? Are there breaks ?</span></span></span>
<span class="r-in"><span><span class="va">oracle.shift</span> <span class="op">&lt;-</span> <span class="fu"><a href="oracle.html">oracle</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, experts <span class="op">=</span> <span class="va">X</span>, loss.type <span class="op">=</span> <span class="st">'percentage'</span>, model <span class="op">=</span> <span class="st">'shifting'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">oracle.shift</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">oracle.shift</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oracle.default(Y = Y, experts = X, model = "shifting", loss.type = "percentage")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       0 shifts 28 shifts 55 shifts 83 shifts 111 shifts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mape:   0.0202    0.0159    0.0154    0.0154     0.0154</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Online aggregation of the experts with BOA</span></span></span>
<span class="r-in"><span><span class="co">#############################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initialize the aggregation rule</span></span></span>
<span class="r-in"><span><span class="va">m0.BOA</span> <span class="op">&lt;-</span> <span class="fu">mixture</span><span class="op">(</span>model <span class="op">=</span> <span class="st">'BOA'</span>, loss.type <span class="op">=</span> <span class="st">'square'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform online prediction using BOA There are 3 equivalent possibilities 1)</span></span></span>
<span class="r-in"><span><span class="co"># start with an empty model and update the model sequentially</span></span></span>
<span class="r-in"><span><span class="va">m1.BOA</span> <span class="op">&lt;-</span> <span class="va">m0.BOA</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">m1.BOA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m1.BOA</span>, newexperts <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>, newY <span class="op">=</span> <span class="va">Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2) perform online prediction directly from the empty model</span></span></span>
<span class="r-in"><span><span class="va">m2.BOA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m0.BOA</span>, newexpert <span class="op">=</span> <span class="va">X</span>, newY <span class="op">=</span> <span class="va">Y</span>, online <span class="op">=</span> <span class="cn">TRUE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3) perform the online aggregation directly</span></span></span>
<span class="r-in"><span><span class="va">m3.BOA</span> <span class="op">&lt;-</span> <span class="fu">mixture</span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, experts <span class="op">=</span> <span class="va">X</span>, model <span class="op">=</span> <span class="st">'BOA'</span>, loss.type <span class="op">=</span> <span class="st">'square'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># These predictions are equivalent:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">m1.BOA</span>, <span class="va">m2.BOA</span><span class="op">)</span>  <span class="co"># TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">m1.BOA</span>, <span class="va">m3.BOA</span><span class="op">)</span>  <span class="co"># TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m3.BOA</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Aggregation rule: BOA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loss function:  squareloss </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gradient trick:  TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    gam    ar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.795 0.205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of experts:  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations:  112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension of the data:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         rmse   mape</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BOA     1480 0.0203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Uniform 1480 0.0206</span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m1.BOA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using d-dimensional time-series</span></span></span>
<span class="r-in"><span><span class="co">##################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Consider the above exemple of electricity consumption </span></span></span>
<span class="r-in"><span><span class="co">#  to be predicted every four weeks</span></span></span>
<span class="r-in"><span><span class="va">YBlock</span> <span class="op">&lt;-</span> <span class="fu"><a href="seriesToBlock.html">seriesToBlock</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Y</span>, d <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">XBlock</span> <span class="op">&lt;-</span> <span class="fu"><a href="seriesToBlock.html">seriesToBlock</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, d <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The four-week-by-four-week predictions can then be obtained </span></span></span>
<span class="r-in"><span><span class="co"># by directly using the `mixture` function as we did earlier. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MLpolBlock</span> <span class="op">&lt;-</span> <span class="fu">mixture</span><span class="op">(</span>Y <span class="op">=</span> <span class="va">YBlock</span>, experts <span class="op">=</span> <span class="va">XBlock</span>, model <span class="op">=</span> <span class="st">"MLpol"</span>, loss.type <span class="op">=</span> <span class="st">"square"</span>, </span></span>
<span class="r-in"><span>                      quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The predictions can finally be transformed back to a </span></span></span>
<span class="r-in"><span><span class="co"># regular one dimensional time-series by using the function `blockToSeries`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prediction</span> <span class="op">&lt;-</span> <span class="fu"><a href="seriesToBlock.html">blockToSeries</a></span><span class="op">(</span><span class="va">MLpolBlock</span><span class="op">$</span><span class="va">prediction</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Using the `online = FALSE` option</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Equivalent solution is to use the `online = FALSE` option in the predict function. </span></span></span>
<span class="r-in"><span><span class="co"># The latter ensures that the model coefficients are not </span></span></span>
<span class="r-in"><span><span class="co"># updated between the next four weeks to forecast.</span></span></span>
<span class="r-in"><span><span class="va">MLpolBlock</span> <span class="op">&lt;-</span> <span class="fu">mixture</span><span class="op">(</span>model <span class="op">=</span> <span class="st">"BOA"</span>, loss.type <span class="op">=</span> <span class="st">"square"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">/</span><span class="va">d</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">*</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span> <span class="co"># next four weeks to be predicted</span></span></span>
<span class="r-in"><span>  <span class="va">MLpolBlock</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">MLpolBlock</span>, newexperts <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span>, newY <span class="op">=</span> <span class="va">Y</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>, online <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>                        quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">MLpolBlock</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.5000000 0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5000000 0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.5000000 0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.5000000 0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.5243539 0.4756461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.5243539 0.4756461</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pierre Gaillard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

